[2024-12-26 17:36:25] Starting invoice generation Context: {
    "commission_id": 375,
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 123,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Commission ID validated Context: {
    "commission_id": 375,
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 153,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Checking product type commission rules Context: {
    "product_type": "Chery Omoda 5 (2023-Present)",
    "query": "SELECT * FROM commission_rules \n                     WHERE status = 'active' \n                     AND rule_type = 'product_type' \n                     AND LOWER(rule_value) = LOWER(?)\n                     LIMIT 1",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 61,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Checking default commission rules Context: {
    "query": "SELECT * FROM commission_rules \n                 WHERE status = 'active' \n                 AND rule_type = 'all'\n                 LIMIT 1",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 84,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] No commission rule found, using default values Context: {
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 101,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Checking product type commission rules Context: {
    "product_type": "Mitsubishi Mirage (2012-Present)",
    "query": "SELECT * FROM commission_rules \n                     WHERE status = 'active' \n                     AND rule_type = 'product_type' \n                     AND LOWER(rule_value) = LOWER(?)\n                     LIMIT 1",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 61,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Checking default commission rules Context: {
    "query": "SELECT * FROM commission_rules \n                 WHERE status = 'active' \n                 AND rule_type = 'all'\n                 LIMIT 1",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 84,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] No commission rule found, using default values Context: {
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 101,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Checking product type commission rules Context: {
    "product_type": "OFFLINE SERVICE",
    "query": "SELECT * FROM commission_rules \n                     WHERE status = 'active' \n                     AND rule_type = 'product_type' \n                     AND LOWER(rule_value) = LOWER(?)\n                     LIMIT 1",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 61,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] Found product type specific rule Context: {
    "id": 6,
    "rule_type": "product_type",
    "rule_value": "OFFLINE SERVICE",
    "commission_percentage": "10.00",
    "status": "active",
    "created_at": "2024-12-11 20:45:45",
    "updated_at": "2024-12-11 20:45:45",
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 69,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 217,
            "function": "getCommissionRate"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] PDF instance created Context: {
    "commission_id": 375,
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 298,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] PDF page added Context: {
    "commission_id": 375,
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 318,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
[2024-12-26 17:36:25] PDF content generation complete Context: {
    "commission_id": 375,
    "request": {
        "method": "GET",
        "uri": "\/shopify-agent-module\/admin\/generate_invoice.php?commission_id=375",
        "get_data": {
            "commission_id": "375"
        },
        "post_data": [],
        "session_data": {
            "user_id": 1,
            "role": "admin",
            "name": "System Admin"
        }
    },
    "backtrace": [
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 396,
            "function": "logError"
        },
        {
            "file": "C:\\xampp\\htdocs\\shopify-agent-module\\admin\\generate_invoice.php",
            "line": 416,
            "function": "generate_invoice"
        }
    ]
}
